<system>
  process_name fluentd_ads_logs
</system>

<source>
  @type http
  port 9880
  bind 0.0.0.0
</source>
<match yospace.break_request>
  @type s3
  aws_key_id "#{ENV['AWS_ACCESS_KEY_ID']}"
  aws_sec_key "#{ENV['[AWS_SECRET_ACCESS_KEY']}"
  s3_bucket asdfa-test-bucket
  s3_region ap-southeast-2
  path logs/yospace/fluentd/break_request/hour=%Y%m%d%H/
  store_as gzip
  <format>
    @type json
  </format>
  # if you want to use ${tag} or %Y/%m/%d/ like syntax in path / s3_object_key_format,
  # need to specify tag for ${tag} and time for %Y/%m/%d in <buffer> argument.
  <buffer tag,time>
    @type file
    path /buffer/s3/yospace/break_request
    timekey 10s # 1 hour partition
    timekey_wait 10s
    timekey_use_utc true # use utc
    chunk_limit_size 256m
  </buffer>
</match>